@using static InHomePlanWeb.Utility.Enums
@model Application
@{
ViewData["Title"] = "Application Details";
}
<link rel="stylesheet" href="~/css/application.css" asp-append-version="true" />
<div class="container">
<form id="Application" class="form" method="post" enctype="multipart/form-data">
   @* @if (TempData["Message"] != null)
   {
   <div class="alert alert-warning">@TempData["Message"]</div>
   }*@
   <h4 class="text-center">Application Details</h4>
   <div asp-validation-summary="ModelOnly" class="text-danger"></div>
   <div>
      <h5>Personal Details</h5>
      <hr>
      <div class="row">
         <div class="col">
            <div class="input-group">
               <label asp-for="FirstName"></label>
               <input asp-for="FirstName" disabled/>
               <span asp-validation-for="FirstName" class="text-danger"></span>
            </div>
         </div>
         <div class="col">
            <div class="input-group">
               <label asp-for="LastName"></label>
               <input asp-for="LastName" disabled/>
               <span asp-validation-for="LastName" class="text-danger"></span>
            </div>
         </div>
      </div>
      <div class="input-group">
         <label asp-for="Address"></label>
         <input asp-for="Address" disabled/>
         <span asp-validation-for="Address" class="text-danger"></span>
      </div>
      <div class="row">
         <div class="col">
            <div class="input-group">
               <label asp-for="Phone"></label>
               <input asp-for="Phone" disabled/>
               <span asp-validation-for="Phone" class="text-danger"></span>
            </div>
         </div>
         <div class="col">
            <div class="input-group">
               <label asp-for="NIC "></label>
               <input asp-for="NIC" disabled/>
               <span asp-validation-for="NIC" class="text-danger"></span>
            </div>
         </div>
      </div>
      <div class="input-group">
         <label asp-for="Email"></label>
         <input asp-for="Email" disabled/>
         <span asp-validation-for="Email" class="text-danger"></span>
      </div>
      <div class="input-group">
         <label asp-for="DateOfBirth"></label>
         <input asp-for="DateOfBirth" disabled/>
         <span asp-validation-for="DateOfBirth" class="text-danger"></span>
      </div>
   </div>
   <!--second part -->
   <div>
      <br>
      <h5>Plan Details</h5>
      <hr>
      <div class="row">
         <div class="col">
            <div class="input-group">           
               <label asp-for="AssessmentNo"></label>
               <input asp-for="AssessmentNo" disabled/>
               <span asp-validation-for="AssessmentNo" class="text-danger"></span>
            </div>
         </div>
         <div class="col">
            <div class="input-group">
               <label asp-for="PostalCode"></label>
               <input asp-for="PostalCode" disabled/>
               <span asp-validation-for="PostalCode" class="text-danger"></span>
            </div>
         </div>
      </div>
      <div class="input-group">
         <label asp-for="StreetName"></label>
         <input asp-for="StreetName" disabled/>
         <span asp-validation-for="StreetName" class="text-danger"></span>
      </div>
      <div class="row">
         <div class="col">
            <div class="input-group">
               <label asp-for="No_Of_Rooms"></label>
               <input asp-for="No_Of_Rooms" disabled/>
               <span asp-validation-for="No_Of_Rooms" class="text-danger"></span>
            </div>
         </div>
         <div class="col">
            <div class="input-group">
               <label asp-for="No_of_perches"></label>
               <input asp-for="No_of_perches" disabled/>
               <span asp-validation-for="No_of_perches" class="text-danger"></span>
            </div>
         </div>
      </div>
      <div class="input-group">
         <label asp-for="BuildingArea"></label>
         <input asp-for="BuildingArea" disabled/>
         <span asp-validation-for="BuildingArea" class="text-danger"></span>
      </div>
   </div>
   <!--third part-->
   <div >
      <div class="input-group">
         <label asp-for="PlanNo"></label>
         <input asp-for="PlanNo" disabled/>
         <span asp-validation-for="PlanNo" class="text-danger"></span>
      </div>
      <div class="row">
         <div class="col">
            <a href="@Url.Action("DownloadFile", "Application", new { filePath = Model.HomePlanFileUrl })" download>
            <i class="fas fa-file-download fa-3x"></i> Download Home Plan
            </a>
         </div>
         <div class="col">
            <a href="@Url.Action("DownloadFile", "Application", new { filePath = Model.LandPlanFileUrl })" download>
            <i class="fas fa-file-download fa-3x"></i> Download Land Plan
            </a>
         </div>
      </div>
   </div>
   <!--fourth part -->
   <div>
      <br/>
      <h5>Approval Details</h5>
      <hr />
      <div class="row">
         <div class="col">
            <div class="input-group">           
               <label asp-for="IsPlanApproved" ></label>
            </div>
         </div>
         <div class="col">
            <div class="input-group">
               <select asp-for="IsPlanApproved" class="form-select">
                  <option value="@BoolOptions.Yes">Yes</option>
                  <option value="@BoolOptions.No">No</option>
               </select>
            </div>
         </div>
      </div>
      <div class="input-group">
         @*<input type="text" name="PlanStatusComment" placeholder="Comments" class="form-control" value="@Model.LastStatus.PlanStatusComment" style="height: 100px">*@
         <textarea name="PlanStatusComment" placeholder="Comments" class="form-control" style="height: 100px; resize: vertical;" maxlength="3000">@Model.LastStatus.PlanStatusComment</textarea>
      </div>
      <div class="row">
         <div class="col">
            <div class="input-group">           
               <label asp-for="IsInspectionCompleted"></label>
            </div>
         </div>
         <div class="col">
            <div class="input-group">
               <select asp-for="IsInspectionCompleted" class="form-select">
                  <option value="@BoolOptions.Yes">Yes</option>
                  <option value="@BoolOptions.No">No</option>
               </select>
            </div>
         </div>
      </div>
      <div class="input-group">
         @*<input type="text" name="InspectionStatusComment" placeholder="Comments" class="form-control" value="" style="height: 100px">*@
         <textarea name="InspectionStatusComment" placeholder="Comments" class="form-control" style="height: 100px; resize: vertical;" maxlength="3000">@Model.LastStatus.InspectionStatusComment</textarea>
      </div>
      <div class="row">
         <div class="col">
            <div class="input-group">           
               <label asp-for="IsFinalApproved"></label>
            </div>
         </div>
         <div class="col">
            <div class="input-group">
               <select asp-for="IsFinalApproved" class="form-select">
                  <option value="@BoolOptions.Yes">Yes</option>
                  <option value="@BoolOptions.No">No</option>
               </select>
            </div>
         </div>
      </div>
      <div class="input-group">
         @*<input type="text" name="FinalStatusComment" placeholder="Comments" class="form-control" value="" style="height: 100px">*@
         <textarea name="FinalStatusComment" placeholder="Comments" class="form-control" style="height: 100px; resize: vertical;" maxlength="3000">@Model.LastStatus.FinalStatusComment</textarea>
      </div>
      <!--final part-->
      <div>
         <div class="row">
            <div class="col">
               <a href="@Url.Action("ApplicationDisplay", "Application")" class="btn">Back to List</a>
            </div>
            <div class="col">
               @*<a href="@Url.Action("ApplicationDetailsAsync", "Application", new { obj = Model })" class="btn btn-red">Update Application</a>*@
               <button type="submit" id="updateButton" class="btn btn-red btn-wide">Update Application</button>
            </div>
         </div>
      </div>
</form>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.1.4"></script>

@section scripts {
      <script>
         document.addEventListener('DOMContentLoaded', function() {
             const payButton = document.getElementById('updateButton');
             payButton.addEventListener('click', function(event) {
                 event.preventDefault(); // Prevent the default form submission behavior
         
                 Swal.fire({
                     title: 'Confirmation',
                     text: 'Are you sure you want to update the application?',
                     icon: 'question',
                     showCancelButton: true,
                     confirmButtonText: 'Yes, update',
                     cancelButtonText: 'No, cancel'
                 }).then((result) => {
                     if (result.isConfirmed) {
                         // Find the application form and disable fields
                        const applicationForm = document.getElementById('Application');
                        const disabledFields = applicationForm.querySelectorAll('[disabled]');
                        disabledFields.forEach(function(field) {
                            field.removeAttribute('disabled');
                        });

                        // Submit the form
                        applicationForm.submit();
                     }
                 });
             });
         });
      </script>
      }

<script>
   // Function to show SweetAlert message box
   function showMessageBox(title, message, icon) {
       Swal.fire({
           //title: title,
           text: message,
           icon: icon,
           showCancelButton: false,
           confirmButtonColor: '#3085d6',
           confirmButtonText: 'OK'
       });
   
   }
   
   // Function to handle form submission
   function submitForm() {
       showMessageBox('Form Submission', 'Application form cannot be submitted.', 'info');
   }
   
   // Check for message in TempData and show the message box
   @if (TempData["Message"] != null)
   {
       var message = TempData["Message"].ToString();
       var messageType = TempData["MessageType"].ToString();
   
       <text>
           showMessageBox('Message', "@message", "@messageType");
       </text>
   }
</script>
</div>
<br>
<script src="https://kit.fontawesome.com/746043b767.js" crossorigin="anonymous"></script>